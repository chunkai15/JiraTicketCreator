<!DOCTYPE html>
<html>
<head>
    <title>API Configuration Test</title>
</head>
<body>
    <h1>API Configuration Test</h1>
    <div id="results"></div>
    
    <script>
        // Test API configuration
        const getApiBaseUrl = () => {
            // Check if we're in development
            if (process.env.NODE_ENV === 'development') {
                return 'http://localhost:3001/api';
            }
            
            // Production environment
            if (process.env.REACT_APP_API_BASE_URL) {
                return process.env.REACT_APP_API_BASE_URL;
            }
            
            // Fallback to current domain + /api for production
            const currentDomain = window.location.origin;
            return `${currentDomain}/api`;
        };

        const apiBaseUrl = getApiBaseUrl();
        
        document.getElementById('results').innerHTML = `
            <p><strong>Current Domain:</strong> ${window.location.origin}</p>
            <p><strong>API Base URL:</strong> ${apiBaseUrl}</p>
            <p><strong>NODE_ENV:</strong> ${process.env.NODE_ENV || 'undefined'}</p>
            <p><strong>REACT_APP_API_BASE_URL:</strong> ${process.env.REACT_APP_API_BASE_URL || 'undefined'}</p>
        `;
        
        // Test API connection
        fetch(`${apiBaseUrl}/health`)
            .then(response => response.json())
            .then(data => {
                document.getElementById('results').innerHTML += `
                    <p><strong>Health Check:</strong> ✅ Success</p>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            })
            .catch(error => {
                document.getElementById('results').innerHTML += `
                    <p><strong>Health Check:</strong> ❌ Failed</p>
                    <p><strong>Error:</strong> ${error.message}</p>
                `;
                
                // Try alternative endpoint
                fetch(`${window.location.origin}/api/health`)
                    .then(response => response.json())
                    .then(data => {
                        document.getElementById('results').innerHTML += `
                            <p><strong>Alternative Health Check:</strong> ✅ Success</p>
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                        `;
                    })
                    .catch(altError => {
                        document.getElementById('results').innerHTML += `
                            <p><strong>Alternative Health Check:</strong> ❌ Failed</p>
                            <p><strong>Error:</strong> ${altError.message}</p>
                        `;
                    });
            });
    </script>
</body>
</html>
